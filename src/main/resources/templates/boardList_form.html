<!DOCTYPE html>
<html lang="ko" layout:decorate="~{layout}">
<head>
    <!--boardList_카테고리_필터-->
    <!-- AJAX 요청 처리e.json()) // 서버에서 받은 JSON 데이터를 처리
            .then(data => { -->
    <script>
        document.getElementById('filterForm').addEventListener('submit', function(event) {
            event.preventDefault(); // 기본 제출 동작을 막습니다.

            var formData = new FormData(this); // 폼 데이터 객체 생성

            // AJAX 요청
            fetch('/board/filter', {
                method: 'POST',
                body: formData
            })
            .then(response => respons
                // 데이터를 받아서 처리할 부분
                console.log('필터링된 결과:', data);
                // 여기에 필요한 DOM 조작이나 페이지 업데이트 로직을 추가하세요
            })
            .catch(error => console.error('에러 발생:', error));
        });
    </script>
    <script>
        function submitForm() {
            var selectElement = document.getElementById("sort");
            var selectedOption = selectElement.options[selectElement.selectedIndex].value;
            var url = selectedOption === "date" ? "/board/date" : "/board/popular";
            window.location.href = url;
        }
    </script>
    <style>
        .pagination{display:-ms-flexbox;display:flex;padding-left:0;list-style:none;border-radius:.25rem}
        .page-link{position:relative;display:block;padding:.5rem .75rem;margin-left:-1px;line-height:1.25;color:#007bff;background-color:#fff;border:1px solid #dee2e6}
        .page-link:hover{z-index:2;color:#0056b3;text-decoration:none;background-color:#e9ecef;border-color:#dee2e6}
        .page-link:focus{z-index:3;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.page-item:first-child
            .page-link{margin-left:0;border-top-left-radius:.25rem;border-bottom-left-radius:.25rem}
            .page-item:last-child .page-link{border-top-right-radius:.25rem;border-bottom-right-radius:.25rem}
            .page-item.active .page-link{z-index:3;color:#fff;background-color:#007bff;border-color:#007bff}
            .page-item.disabled .page-link{color:#6c757d;pointer-events:none;cursor:auto;background-color:#fff;border-color:#dee2e6}
            .pagination-lg .page-link{padding:.75rem 1.5rem;font-size:1.25rem;line-height:1.5}
            .pagination-lg .page-item:first-child .page-link{border-top-left-radius:.3rem;border-bottom-left-radius:.3rem}
            .pagination-lg .page-item:last-child .page-link{border-top-right-radius:.3rem;border-bottom-right-radius:.3rem}
            .pagination-sm .page-link{padding:.25rem .5rem;font-size:.875rem;line-height:1.5}
            .pagination-sm .page-item:first-child .page-link{border-top-left-radius:.2rem;border-bottom-left-radius:.2rem}
            .pagination-sm .page-item:last-child .page-link{border-top-right-radius:.2rem;border-bottom-right-radius:.2rem}
            .badge{display:inline-block;padding:.25em .4em;font-size:75%;font-weight:700;line-height:1;text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:.25rem;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}
            @media (prefers-reduced-motion:reduce){.badge{transition:none}}
            a.badge:focus,a.badge:hover{text-decoration:none}
            .badge:empty{display:none}
            .btn .badge{position:relative;top:-1px}
            .badge-pill{padding-right:.6em;padding-left:.6em;border-radius:10rem}
            .badge-primary{color:#fff;background-color:#007bff}
            a.badge-primary:focus,a.badge-primary:hover{color:#fff;background-color:#0062cc}
            a.badge-primary.focus,a.badge-primary:focus{outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.5)}
            .badge-secondary{color:#fff;background-color:#6c757d}
            a.badge-secondary:focus,a.badge-secondary:hover{color:#fff;background-color:#545b62}
            a.badge-secondary.focus,a.badge-secondary:focus{outline:0;box-shadow:0 0 0 .2rem rgba(108,117,125,.5)}
            .badge-success{color:#fff;background-color:#28a745}
            a.badge-success:focus,a.badge-success:hover{color:#fff;background-color:#1e7e34}
            a.badge-success.focus,a.badge-success:focus{outline:0;box-shadow:0 0 0 .2rem rgba(40,167,69,.5)}
            .badge-info{color:#fff;background-color:#17a2b8}
            a.badge-info:focus,a.badge-info:hover{color:#fff;background-color:#117a8b}
            a.badge-info.focus,a.badge-info:focus{outline:0;box-shadow:0 0 0 .2rem rgba(23,162,184,.5)}
            .badge-warning{color:#212529;background-color:#ffc107}
            a.badge-warning:focus,a.badge-warning:hover{color:#212529;background-color:#d39e00}
            a.badge-warning.focus,a.badge-warning:focus{outline:0;box-shadow:0 0 0 .2rem rgba(255,193,7,.5)}
            .badge-danger{color:#fff;background-color:#dc3545}
            a.badge-danger:focus,a.badge-danger:hover{color:#fff;background-color:#bd2130}
            a.badge-danger.focus,a.badge-danger:focus{outline:0;box-shadow:0 0 0 .2rem rgba(220,53,69,.5)}
            .badge-light{color:#212529;background-color:#f8f9fa}
            a.badge-light:focus,a.badge-light:hover{color:#212529;background-color:#dae0e5}
            a.badge-light.focus,a.badge-light:focus{outline:0;box-shadow:0 0 0 .2rem rgba(248,249,250,.5)}
            .badge-dark{color:#fff;background-color:#343a40}
            a.badge-dark:focus,a.badge-dark:hover{color:#fff;background-color:#1d2124}
            a.badge-dark.focus,a.badge-dark:focus{outline:0;box-shadow:0 0 0 .2rem rgba(52,58,64,.5)}
            .jumbotron{padding:2rem 1rem;margin-bottom:2rem;background-color:#e9ecef;border-radius:.3rem}
            @media (min-width:576px){.jumbotron{padding:4rem 2rem}}}
        .pagination-wrapper {
        display: flex;
        justify-content: center;
        margin-bottom: 100px;
    }
    .pagination {
        display: flex;
        justify-content: center;
        margin-bottom: 100px;
    }
    </style>
</head>
<body>
<div layout:fragment="content">
    <div class="filter-container">
        <div class="collapse bg-base-200">
            <input type="checkbox" />
            <div class="collapse-title text-xl font-medium">
                <img class="category" src="/img/filter.png" style="width:25px;height:25px;" onclick="toggleCategory()">
            </div>
            <form class="collapse-content">
                <div class="category">
                    <span onclick="toggleCategory('location')"><b>지역</b></span><br>
                    <label><input type="checkbox" value="서울"> 서울</label>
                    <label><input type="checkbox" value="경기"> 경기</label>
                    <label><input type="checkbox" value="충북"> 충북</label>
                    <label><input type="checkbox" value="충남"> 충남</label>
                    <label><input type="checkbox" value="전북"> 전북</label>
                    <label><input type="checkbox" value="전남"> 전남</label>
                    <label><input type="checkbox" value="경남"> 경남</label>
                    <label><input type="checkbox" value="경북"> 경북</label>
                    <label><input type="checkbox" value="강원"> 강원</label>
                    <label><input type="checkbox" value="인천"> 인천</label>
                    <label><input type="checkbox" value="대구"> 대구</label>
                    <label><input type="checkbox" value="부산"> 부산</label>
                    <label><input type="checkbox" value="울산"> 울산</label>
                    <label><input type="checkbox" value="대전"> 대전</label>
                    <label><input type="checkbox" value="광주"> 광주</label>
                    <label><input type="checkbox" value="제주"> 제주</label>
                </div>

                <hr>

                <div class="category">
                    <span onclick="toggleCategory('food')"><b>음식</b></span><br>
                    <label><input type="checkbox" value="한식"> 한식</label>
                    <label><input type="checkbox" value="중식"> 중식</label>
                    <label><input type="checkbox" value="일식"> 일식</label>
                    <label><input type="checkbox" value="아시아"> 아시아</label>
                    <label><input type="checkbox" value="양식"> 양식</label>
                    <label><input type="checkbox" value="디저트"> 디저트</label>
                </div>

                <hr>

                <div class="category">
                    <span onclick="toggleCategory('gender')"><b>성별</b></span><br>
                    <label><input type="checkbox" value="여"> 여</label>
                    <label><input type="checkbox" value="남"> 남</label>
                    <label><input type="checkbox" value="무관"> 무관</label>
                </div>
                <div class="submit-container">
                    <input type="submit" class="btn" value="적용">
                </div>
            </form>
        </div>
    </div>

    <form id="sortForm" onchange="submitForm()">
        <label for="sort">정렬:</label>
        <select id="sort" name="sort">
            <option value="date" th:selected="${sort == 'date'}">최신순</option>
            <option value="popular" th:selected="${sort == 'popular'}">인기순</option>
        </select>
    </form>

    <div class="post-container">
        <th:block th:each="board : ${boards}">
            <a class="post" th:href="@{|/board/${board.id}|}">
                <div th:if="${!#lists.isEmpty(board.images)}">
                    <img th:src="${board.images[0].url}" alt="음식사진" style="width:200px; height:100%;">
                </div>
                <div class="post-content">
                    <div class="post-title" th:text="${board.title}"></div>
                    <div class="post-details">
                        <div th:text="${board.restName}"></div>
                        <div th:text="${board.address}"></div>
                    </div>
                    <div class="post-tags">
<!--                        <span th:each="tag : ${board.tags}" th:text="${tag}"></span>-->
                    </div>
                    <div class="post-footer">
                        <span th:text="'❤️ ' + ${board.voter.size()}"></span>
                        <span th:text="'💬 ' + ${board.commentList.size()}"></span>
                    </div>
                </div>
            </a>
        </th:block>
    </div>

    <!-- 페이징처리 시작 -->
    <div class="pagination-wrapper" th:if="${!boards.isEmpty()}">
        <ul class="pagination">
            <li class="page-item" th:classappend="${!boards.hasPrevious} ? 'disabled'">
                <a class="page-link"
                   th:href="@{|?page=${boards.number-1}|}">
                    <span>이전</span>
                </a>
            </li>
            <li th:each="page: ${#numbers.sequence(0, boards.totalPages-1)}"
                th:if="${page >= boards.number-5 and page <= boards.number+5}"
                th:classappend="${page == boards.number} ? 'active'"
                class="page-item">
                <a th:text="${page}" class="page-link" th:href="@{|?page=${page}|}"></a>
            </li>
            <li class="page-item" th:classappend="${!boards.hasNext} ? 'disabled'">
                <a class="page-link" th:href="@{|?page=${boards.number+1}|}">
                    <span>다음</span>
                </a>
            </li>
        </ul>
    </div>
    <!-- 페이징처리 끝 -->

</div>
</body>
</html>